# 索引优化

## 1 索引的基本知识

### 1.1 索引的优点

### 1.2 索引的用处

### 1.3 索引的分类

### 1.4 索引的数据结构

### 1.5 索引匹配方式

![image-20200810224703468](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200810224703468.png)

#### 1.5.1 全值匹配

全值匹配指的是和索引中的所有的列进行匹配

```sql
explain select * from staffs where name = 'July' and age = '23' and pos = 'dev';
```

![image-20200810230322818](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200810230322818.png)

#### 1.5.2 匹配最左前缀

只匹配前面几个列

```sql
explain select * from staffs where name = 'July' and age = '23';
```

![image-20200810230617106](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200810230617106.png)

```sql
explain select * from staffs where name = 'July';
```

![image-20200810230638970](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200810230638970.png)

#### 1.5.3 匹配列前缀

可以匹配某一列的值的开头部分

```sql
explain select * from staffs where name like 'J%';
```

![image-20200810231037127](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200810231037127.png)

编写sql时一定不要将通配符放在前面，即使有索引也不会使用

![image-20200810231058996](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200810231058996.png)

#### 1.5.4 匹配范围值

```sql
explain select * from staffs where name > 'Mary';
```

![image-20200810231707357](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200810231707357.png)

#### 1.5.5 精确匹配某一列并范围匹配另外一列

可以查询第一列的全部和第二列的部分

```sql
explain select * from staffs where name = 'July' and age > 25;
```

![image-20200810232018094](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200810232018094.png)

```sql
explain select * from staffs where name = 'July' and pos > 25;
```

与上面对比，正确顺序是name，age，pos，此时用不到pos，只匹配name，所以pos > 25没有用，ref = constant。

![image-20200810232248497](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200810232248497.png)

#### 1.5.6 只访问索引的查询

查询的时候只需要访问索引，不需要访问数据行，本质上就是覆盖索引

```sql
explain select name,age,pos from staffs where name = 'July' and age = 25 and pos = 'dev';
```

![image-20200810233017183](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200810233017183.png)

### 1.6  面试

