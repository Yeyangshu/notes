# 优化

## 1 数据类型优化

### 1.1 最小数据类型

应该尽量使用可以正确存储数据的最小数据类型，更小的数据类型通常更快，因为它们占用更少的磁盘、内存和CPU缓存，并且处理时需要的CPU周期更少，但是要确保没有低估需要存储的值的范围，如果无法确认哪个数据类型，就选择你认为不会超过范围的最小类型
案例：
设计两张表，设计不同的数据类型，查看表的容量。因为4k存储，数据类型小的实际占用的空间更小

### 1.2 简单数据类型

简单数据类型的操作通常需要更少的CPU周期，例如

- 整型值字符型操作代价更低，因为字符集和校对规则时字符比较比整型比较更复杂。

- 使用MySQL自建类型而不是字符串来存储日期和时间

  emp表使用date，emp2使用varchar

  ![image-20200808165811799](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200808165811799.png)

  ![image-20200808165843755](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200808165843755.png)

- 用整型存储ip地址

  使用函数进行转换

  ![image-20200808170115683](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200808170115683.png)

  可以防止地址写错

  ![image-20200808170154869](https://yeyangshu-picgo.oss-cn-shanghai.aliyuncs.com/img/image-20200808170154869.png)

### 1.3 较量避免null

如果查询中包含可为NULL的列，对mysql来说很难优化，因为可为null的列使得索引、索引统计和值比较都更加复杂，坦白来说，通常情况下null的列改为not null带来的性能提升比较小，所有没有必要将所有的表的schema进行修改，但是应该尽量避免设计成可为null的列

### 1.4 实际细则

#### 1.4.1 整数类型

可以使用的几种整数类型：TINYINT，SMALLINT，MEDIUMINT，INT，BIGINT分别使用8，16，24，32，64位存储空间。
尽量使用满足需求的最小数据类型

#### 1.4.2 字符和字符串类型

1. char长度固定，即每条数据占用等长字节空间；最大长度是255个字符，适合用在身份证号、手机号等定长字符串
2. varchar可变程度，可以设置最大长度；最大空间是65535个字节，适合用在长度可变的属性
3. text不设置长度，当不知道属性的最大长度时，适合用text

按照查询速度：char > varchar > text

##### 1.4.2.1 varchar



##### 1.4.2.2 char

#### 1.4.3 BLOB和TEXT类型

## 2 合理使用范式和反范式

## 3 主键的选择

## 4 字符集的选择

utf8mb4

## 5 适当的数据冗余

## 6适当拆分

